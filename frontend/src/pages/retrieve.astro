---
import Layout from '../layouts/formLayout.astro';
import Card from '../components/formComponents/formCard.astro';
import FormField from "../components/formComponents/formField.astro";
import StardewBackground from '../components/pageComponents/stardewBackground.astro';
import Toast from "../components/formComponents/toast.astro";

---

<Layout title="Recuperação de senha">

	<script>

		import * as yup from "yup";
		import sleep from 'sleep-promise';

		function login (event) {

			event.preventDefault ();

			let data = {
				email : document.querySelector ("#email").value
			}

			let validation = yup.object ().shape ({
				email : yup.string().email().required()
                
			});

			validation.validate (data).then (() => {
				console.log ("passou");
			})
			.catch(async () => {
				let toast = document.getElementById("toast");
				toast.style.display="block";
				await sleep(3000);
				toast.style.display="none";
			});

		}

		document.getElementById ("button").addEventListener ("click" , login)
	</script>

	<main>

		<StardewBackground />

		<Card
			href="/login"
			title="Recuperação de senha"
			description="Não se preocupe, basta informar seu email já cadastrado e enviaremos uma notificação na velocidade da luz."
			hrefText = "Já tem conta ?"
			submitValue = "Recuperar conta"
            hrefTwo = "/signup"
			hrefTwoText = "Não tenho conta"
		>
			<FormField
					type = "email"
					title = "Email"
					id = "email"
			/>

		</Card>
		<Toast message="Credencial inválida"/>
	</main>
</Layout>